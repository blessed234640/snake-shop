{% extends "shop/base.html" %}
{% load i18n static %}
{% load currency_tags %}

{% block title %}
    {% if category %}
        {{ category.name }} - {% translate "Snake Paradise" %}
    {% else %}
        {% translate "Premium snakes" %} - {% translate "Snake Paradise" %}
    {% endif %}
{% endblock %}

{% block content %}
<div class="catalog-container">
    <div id="sidebar">
        <h3>üêç {% translate "Categories" %}</h3>
        <ul>
            <li {% if not category %}class="selected"{% endif %}>
                <a href="{% url 'shop:product_list' %}">
                    üåü {% translate "All products" %}
                </a>
            </li>
            {% for c in categories %}
            <li {% if category.slug == c.slug %}class="selected"{% endif %}>
                <a href="{{ c.get_absolute_url }}">
                    {{ c.name }}
                </a>
            </li>
            {% endfor %}
        </ul>

        <div class="care-tips">
            <h4>‚ÑπÔ∏è {% translate "Care tips" %}</h4>
            <p>
                {% translate "All our snakes come with detailed care instructions and health guarantee." %}
            </p>
        </div>
    </div>

    <div id="main" class="product-list-container">
        <div class="page-header">
            <h1>
                {% if category %}
                    {{ category.name }}
                {% else %}
                    üêç {% translate "Premium snake collection" %}
                {% endif %}
            </h1>
            <p class="page-description">
                {% if category %}
                    {% blocktranslate with category_name=category.name %}
                        Explore our selection of {{ category_name }} snakes
                    {% endblocktranslate %}
                {% else %}
                    {% translate "Discover our exclusive collection of healthy and well-cared reptiles" %}
                {% endif %}
            </p>
        </div>

        <div class="product-list">
            {% for product in products %}
            <div class="item">
                <a href="{{ product.get_absolute_url }}">
                    <img
                        src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'shop/img/no_image.png' %}{% endif %}"
                        alt="{{ product.name }}"
                    />
                    <h3 class="product-name">{{ product.name }}</h3>
                </a>
                <div class="price">{{ product.price|currency }}</div>
                <form action="{% url 'cart:cart_add' product.id %}" method="post">
                    {{ cart_product_form }}
                    {% csrf_token %}
                    <input
                        type="submit"
                        value='üõí {% translate "Add to cart" %}'
                        class="button add-to-cart-btn"
                    />
                </form>
            </div>
            {% empty %}
            <div class="empty-category">
                <h3>{% translate "No snakes in this category yet" %}</h3>
                <p>
                    {% translate "Check back later - new arrivals coming soon!" %}
                </p>
                <a href="{% url 'shop:product_list' %}" class="button">
                    {% translate "View all snakes" %}
                </a>
            </div>
            <!-- –í—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –±–ª–æ–∫ –≤ product-list.html -->
            <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; border: 1px solid #ccc;">
                <strong>DEBUG Price Information:</strong><br>
                Product: {{ product.name }}<br>
                Original Price: {{ product.price }}<br>
                Currency Filter Result: {{ product.price|currency }}<br>
                Current Language: {{ request.LANGUAGE_CODE }}<br>
                Currency Rate: {% get_current_language as LANGUAGE_CODE %}{{ CURRENCIES.LANGUAGE_CODE.rate }}
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}