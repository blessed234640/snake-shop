{% extends "shop/base.html" %} 
{% load i18n %} 

{% block title %}
  {% translate "Checkout" %} - {% translate "Snake Paradise" %}
{% endblock %} 

{% block content %}
<div class="checkout-container">
    <h1>üìã {% translate "Checkout" %}</h1>

    <div
        style="
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 3rem;
            margin-top: 2rem;
        "
    >
        <div>
            <h2 style="color: var(--accent-primary); margin-bottom: 1.5rem">
                {% translate "Shipping information" %}
            </h2>
            <form
                method="post"
                style="
                    background: var(--bg-card);
                    padding: 2rem;
                    border-radius: var(--border-radius);
                    border: 1px solid var(--border-color);
                "
            >
                {% csrf_token %}

                <div style="display: grid; gap: 1.5rem">
                    {% for field in form %}
                    <div style="margin-bottom: 1.5rem">
                        <label
                            for="{{ field.id_for_label }}"
                            style="
                                display: block;
                                margin-bottom: 0.5rem;
                                font-weight: 500;
                                color: var(--text-primary);
                            "
                        >
                            {{ field.label }} 
                            {% if field.field.required %}
                            <span style="color: #dc3545">*</span>
                            {% endif %}
                        </label>
                        {{ field }} 
                        {% if field.errors %}
                        <div
                            style="
                                color: #dc3545;
                                font-size: 0.9rem;
                                margin-top: 0.5rem;
                            "
                        >
                            {% for error in field.errors %}‚ö†Ô∏è {{ error }} {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>

                <div
                    style="
                        display: flex;
                        gap: 1rem;
                        justify-content: space-between;
                        margin-top: 2rem;
                    "
                >
                    <a href="{% url 'cart:cart_detail' %}" class="button light">
                        ‚Üê {% translate "Back to cart" %}
                    </a>
                    <input
                        type="submit"
                        value='üêç {% translate "Place order" %} ‚Üí'
                        class="button"
                    />
                </div>
            </form>
        </div>

        <div>
            <div
                style="
                    background: var(--bg-card);
                    padding: 2rem;
                    border-radius: var(--border-radius);
                    border: 1px solid var(--border-color);
                    margin-bottom: 2rem;
                "
            >
                <h3 style="color: var(--accent-primary); margin-bottom: 1rem">
                    üì¶ {% translate "Your order" %}
                </h3>
                <div style="margin: 1.5rem 0">
                    {% for item in cart %}
                    <div
                        style="
                            display: flex;
                            justify-content: space-between;
                            padding: 0.8rem 0;
                            border-bottom: 1px solid var(--border-color);
                        "
                    >
                        <div>
                            <span style="color: var(--text-secondary)">
                                {{ item.quantity }}x
                            </span>
                            <span style="margin-left: 0.5rem">
                                {{ item.product.name }}
                            </span>
                        </div>
                        <span style="font-weight: 600">
                            ‚ÇΩ{{ item.total_price }}
                        </span>
                    </div>
                    {% endfor %}
                    {% if cart.coupon %}
                    <li>
                        {% blocktranslate with code=cart.coupon.code discount=cart.coupon.discount %}
                            "{{ code }}" ({{ discount }}% off)
                        {% endblocktranslate %}
                        <span class="neg">- ‚ÇΩ{{ cart.get_discount|floatformat:2 }}</span>
                    </li>
                    {% endif %}
                </div>
                <div
                    style="
                        border-top: 2px solid var(--accent-primary);
                        padding-top: 1rem;
                        text-align: right;
                        font-size: 1.2rem;
                    "
                >
                    <strong>{% translate "Total" %}: ‚ÇΩ{{ cart.get_total_price_after_discount|floatformat:2 }}</strong>
                </div>
            </div>

            <div
                style="
                    background: var(--bg-card);
                    padding: 1.5rem;
                    border-radius: var(--border-radius);
                    border: 1px solid var(--border-color);
                "
            >
                <h4 style="color: var(--accent-primary); margin-bottom: 1rem">
                    üöö {% translate "Delivery" %}
                </h4>
                <p
                    style="
                        color: var(--text-secondary);
                        font-size: 0.9rem;
                        margin-bottom: 1rem;
                    "
                >
                    {% translate "All snakes are delivered by specialized carriers with live delivery guarantee." %}
                </p>
                <ul style="list-style: none; color: var(--text-secondary)">
                    <li style="padding: 0.3rem 0">
                        ‚úì {% translate "Thermoregulated packaging" %}
                    </li>
                    <li style="padding: 0.3rem 0">
                        ‚úì {% translate "Next day express delivery" %}
                    </li>
                    <li style="padding: 0.3rem 0">
                        ‚úì {% translate "Live delivery guarantee" %}
                    </li>
                    <li style="padding: 0.3rem 0">
                        ‚úì {% translate "Veterinary certificate included" %}
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}