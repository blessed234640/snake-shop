{% extends "shop/base.html" %} {% load static %} {% block title %} –ö–æ—Ä–∑–∏–Ω–∞
–ø–æ–∫—É–ø–æ–∫ - Snake Paradise {% endblock %} {% block content %}
<div class="cart-container">
    <h1>üõí –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–æ–∫</h1>

    {% if cart %}
    <div class="cart">
        <table>
            <thead>
                <tr>
                    <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                    <th>–¢–æ–≤–∞—Ä</th>
                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                    <th>–£–¥–∞–ª–∏—Ç—å</th>
                    <th>–¶–µ–Ω–∞ –∑–∞ —à—Ç.</th>
                    <th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th>
                </tr>
            </thead>
            <tbody>
                {% for item in cart %} {% with product=item.product %}
                <tr>
                    <td>
                        <a href="{{ product.get_absolute_url }}">
                            <img
                                src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'shop/img/no_image.png' %}{% endif %}"
                                alt="{{ product.name }}"
                            />
                        </a>
                    </td>
                    <td>
                        <a
                            href="{{ product.get_absolute_url }}"
                            style="color: var(--text-primary); font-weight: 500"
                        >
                            {{ product.name }}
                        </a>
                    </td>
                    <td>
                        <form
                            action="{% url 'cart:cart_add' product.id %}"
                            method="post"
                            class="quantity-form"
                        >
                            {{ item.update_quantity_form.quantity }}
                            <input
                                type="submit"
                                value="–û–±–Ω–æ–≤–∏—Ç—å"
                                class="button light"
                                style="padding: 8px 16px"
                            />
                            {% csrf_token %}
                        </form>
                    </td>
                    <td>
                        <form
                            action="{% url 'cart:cart_remove' product.id %}"
                            method="post"
                        >
                            <input
                                type="submit"
                                value="üóë –£–¥–∞–ª–∏—Ç—å"
                                class="button"
                                style="background: #dc3545; padding: 8px 16px"
                            />
                            {% csrf_token %}
                        </form>
                    </td>
                    <td class="num">‚ÇΩ{{ item.price }}</td>
                    <td class="num">‚ÇΩ{{ item.total_price }}</td>
                </tr>
                {% endwith %} {% endfor %} {% if cart.coupon %}
                <tr class="subtotal">
                    <td>–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∏—Ç–æ–≥</td>
                    <td colspan="4"></td>
                    <td class="num">
                        ‚ÇΩ{{ cart.get_total_price|floatformat:2 }}
                    </td>
                </tr>
                <tr>
                    <td>
                        –ö—É–ø–æ–Ω"{{cart.coupon.code}}"(—Å–∫–∏–¥–∫–∞{{cart.coupon.discount}}%)
                    </td>
                    <td colspan="4"></td>
                    <td class="num neg">
                        - ‚ÇΩ{{ cart.get_discount|floatformat:2 }}
                    </td>
                </tr>
                {% endif %}

                <tr class="total">
                    <td colspan="5"><strong>–ò—Ç–æ–≥–æ</strong></td>
                    <td class="num">
                        <strong
                            >‚ÇΩ{{cart.get_total_price_after_discount|floatformat:2}}</strong
                        >
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- –ë–ª–æ–∫ —Å –∫—É–ø–æ–Ω–æ–º -->
    <div
        class="coupon-section"
        style="
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
        "
    >
        <h3 style="color: var(--accent-primary); margin-bottom: 1rem">
            –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫—É–ø–æ–Ω:
        </h3>
        <form
            action="{% url 'coupons:apply' %}"
            method="post"
            style="display: flex; gap: 1rem; align-items: flex-end"
        >
            {{ coupon_apply_form }}
            <input
                type="submit"
                value="–ü—Ä–∏–º–µ–Ω–∏—Ç—å"
                class="button light"
                style="padding: 10px 20px"
            />
            {% csrf_token %}
        </form>
    </div>
    <!-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
    <div class="cart-actions">
        <a href="{% url 'shop:product_list' %}" class="button light">
            ‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
        </a>
        <a href="{% url 'orders:order_create' %}" class="button">
            üêç –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ ‚Üí
        </a>
    </div>
    {% else %}
    <div
        style="
            text-align: center;
            padding: 3rem;
            background: var(--bg-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
        "
    >
        <h2 style="color: var(--text-secondary); margin-bottom: 1rem">
            –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞
        </h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem">
            –û—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Å–µ–±—è –Ω–∞—à—É —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é –∑–º–µ–π!
        </p>
        <a href="{% url 'shop:product_list' %}" class="button">
            –°–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
